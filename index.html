<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>プロセカ・イベントボーダー予測</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary-bg: #0f172a;
            --accent-main: #22d3ee; 
            --accent-sub: #f472b6;  
            --accent-main-rgb-const: 34, 211, 238;
            --accent-sub-rgb-const: 244, 114, 182;
            --card-glass: rgba(30, 41, 59, 0.7);
            --bg-gradient-main-rgb: 34, 211, 238;
            --bg-gradient-sub-rgb: 244, 114, 182;
        }

        body {
            background-color: var(--primary-bg);
            background-image: 
                radial-gradient(at 0% 0%, rgba(var(--bg-gradient-main-rgb), 0.15) 0, transparent 50%),
                radial-gradient(at 100% 100%, rgba(var(--bg-gradient-sub-rgb), 0.15) 0, transparent 50%);
            color: #f8fafc;
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif;
            min-height: 100vh;
            transition: background-image 0.8s ease;
        }

        .glass-card {
            background: var(--card-glass);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 1rem;
            box-shadow: 0 10px 25px -5px rgba(0,0,0,0.3);
        }

        .neon-text-main {
            color: var(--accent-main);
            text-shadow: 0 0 10px rgba(var(--accent-main-rgb-const), 0.8);
        }

        .rank-highlight {
            color: var(--accent-main);
        }
    </style>
</head>

<body class="p-4 md:p-8">
<div class="max-w-6xl mx-auto space-y-8">

<header class="glass-card p-6">
    <h1 id="event-name" class="text-3xl font-black neon-text-main">--</h1>
    <p class="text-slate-400 text-sm">
        最終更新: <span id="last-update">--</span>
    </p>
</header>

<section class="glass-card p-6">
    <h2 class="text-xl font-bold mb-4">
        <i class="fa-solid fa-chart-line"></i> ボーダー確認・予測
    </h2>

    <div class="overflow-x-auto">
        <table class="w-full">
            <thead>
                <tr class="border-b border-slate-700 text-xs text-slate-400">
                    <th class="py-2 px-3">順位</th>
                    <th class="py-2 px-3">実績(21時)</th>
                    <th class="py-2 px-3">翌日21時予測</th>
                    <th class="py-2 px-3">最終予測(p50)</th>
                    <th class="py-2 px-3">安全圏(p90)</th>
                </tr>
            </thead>
            <tbody id="border-table-body"></tbody>
        </table>
    </div>
</section>

</div>

<script>
/* ===============================
   数値フォーマット（小数点切り捨て）
   =============================== */
const formatNumber = (num) =>
    (num === null || num === undefined)
        ? "---"
        : Math.floor(Number(num)).toLocaleString();

/* ===============================
   データ描画
   =============================== */
function renderLatest(data) {
    document.getElementById("event-name").textContent = data.event?.name ?? "--";
    document.getElementById("last-update").textContent =
        `${data.snapshot?.jst_date ?? "--"} ${data.snapshot?.approx_time ?? ""}`;

    const tbody = document.getElementById("border-table-body");
    tbody.innerHTML = "";

    Object.keys(data.ranks)
        .sort((a,b) => Number(a) - Number(b))
        .forEach(rank => {
            const r = data.ranks[rank];
            const tr = document.createElement("tr");
            tr.className = "border-b border-slate-800";

            tr.innerHTML = `
                <td class="py-3 px-3 font-bold rank-highlight">TOP ${rank}</td>
                <td class="py-3 px-3 font-mono">${formatNumber(r.actual)}</td>
                <td class="py-3 px-3 font-mono text-slate-400">${formatNumber(r.next_21)}</td>
                <td class="py-3 px-3 font-mono font-bold text-pink-400">${formatNumber(r.final_p50)}</td>
                <td class="py-3 px-3 font-mono font-bold text-cyan-400">${formatNumber(r.final_p90)}</td>
            `;
            tbody.appendChild(tr);
        });
}

/* ===============================
   初期化（mock）
   =============================== */
const mockLatest = {
    event: { name: "導く想い、結ぶ縁" },
    snapshot: { jst_date: "2026-01-02", approx_time: "22:50" },
    ranks: {
        "100": { actual:14638897, next_21:20816362.5955, final_p50:69886778.5587, final_p90:76585948.8165 },
        "200": { actual:8240780, next_21:11353589.1336, final_p50:34613206.838, final_p90:38792159.3143 }
    }
};

document.addEventListener("DOMContentLoaded", () => {
    renderLatest(mockLatest);
});
</script>
</body>
</html>
